<!DOCTYPE html>
<html>
<head>
    <title>Döküm Kayıt Formu</title>
    <meta charset="UTF-8">
    <style>
        .matrix-table {
            border-collapse: collapse;
            margin-top: 10px;
        }
        .matrix-table td, .matrix-table th {
            border: 1px solid #999;
            width: 35px;
            height: 35px;
            text-align: center;
            cursor: pointer;
        }
        .matrix-table .header {
            background-color: #eee;
            cursor: default;
        }
        .matrix-table .selected {
            background-color: lightcoral;
        }
    </style>
</head>
<body>
    <h2>Döküm Kayıt Formu</h2>
    <form method="POST">
        <label>Tarih:</label><br>
        <input type="date" name="tarih" required><br><br>

        <label>Döküm No:</label><br>
        <input type="text" name="dokum_no" required><br><br>

        <label>Alaşım:</label><br>
        <input type="text" name="alasim" required><br><br>

        <label>Sıcaklık (°C):</label><br>
        <input type="text" name="sicaklik"><br><br>

        <label>Notlar:</label><br>
        <textarea name="notlar"></textarea><br><br>

        <h3>Kalıp Başarı Matrisi (6x7) – <i>Başarısız kalıpları seç</i></h3>

        <table class="matrix-table" id="matrix">
            <tr>
                <th class="header"></th>
                {% for col in ['A','B','C','D','E','F','G'] %}
                    <th class="header">{{ col }}</th>
                {% endfor %}
            </tr>
            {% for row in range(1,7) %}
            <tr>
                <th class="header">{{ row }}</th>
                {% for col in range(7) %}
                    <td onclick="toggleCell(this)"></td>
                {% endfor %}
            </tr>
            {% endfor %}
        </table>

        <input type="hidden" name="kalip" id="kalipInput">

        <br>
        <button type="submit">Kaydet</button>
    </form>

    <script>
        function toggleCell(cell) {
            if (!cell.classList.contains("header")) {
                cell.classList.toggle("selected");
                updateMatrixData();
            }
        }

        function updateMatrixData() {
            const table = document.getElementById("matrix");
            const cells = table.querySelectorAll("td");
            const values = Array.from(cells).map(cell => cell.classList.contains("selected") ? "1" : "0");
            document.getElementById("kalipInput").value = values.join(",");
        }
    </script>
</body>
</html>
